{ZL.Source id="节点栏目信息数据源"/}
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>{$SiteName/}</title>
<meta name="Keywords" content="{SField sid="节点栏目信息数据源" FD="Meta_Keywords" page="0"/}" />
<meta name="description" content="{SField sid="节点栏目信息数据源" FD="Meta_Description" page="0"/}" />
{ZL:Boot()/}
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
<link href="/dist/css/weui.min.css" rel="stylesheet"/>
<link href="{$CssDir/}global.css?Version={ZL.Label id="前端样式版本号"/}" rel="stylesheet"/>
<script src="/JS/Controls/B_User.js"></script>
<script>
$.post("/API/UserCheck.ashx?action=HasLogged", "", function (data) {
	if (!data || data == "-1") {
		location = "/wxpromo.aspx?r="+window.location.href;
	}
});
</script>
<style>
.slider{display:none}/*用于获取更加体验*/
.focus span{width:10px;height:10px;margin-right:10px;border-radius:50%;background:#666;font-size:0}
.focus span.current{background:#fff}
.slider ul { margin-bottom:0; padding-left:0; list-style:none;}
.shop_list .col-xs-12 { padding-left:5px; padding-right:5px;}
.shop_list_c { margin-top:10px;}
.shop_list_cm span { height:48px; overflow:hidden;}
.shop_list_cp .btn { padding:5px; font-size:10px;}
.shop_li.st_cp strong { font-size:1.2em; line-height:normal;}
.slider li a span { display:block; position:absolute; padding-left:50px; top:50%; text-align:center; color:#fff; font-family:"ZoomlaXingtiJ3"; text-shadow:0 0 5px rgba(0,0,0,0.55); font-size:2em;}
.weui_mask, .weui_mask_transition, .weui_mask_transparent { z-index:2001;}
.weui_dialog { z-index:2013;}
.mobile_food_cb { padding-bottom:10px;}
.mobile_food_c { margin-bottom:0;}
</style>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" id="wei_nav">
<div class="container-fluid">
<!-- Brand and toggle get grouped for better mobile display -->
<div class="navbar-header">
<a class="navbar-brand" href="{ZL:GetNodeLinkUrl(2)/}"><h3>我点吧</h3></a>
</div>
</div><!-- /.container-fluid -->
</nav>



<div class="container" style="height:50px;"></div>
<div class="mobile_class" style="margin-top:5px;">
<ul>
<li><a data-node="拌粉" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(拌粉)$}&sid=&remark={$GetRequest(remark)$}"><span></span>拌粉</a></li>
<li><a data-node="拌面" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(拌面)$}&sid=&remark={$GetRequest(remark)$}"><span></span>拌面</a></li>
<li><a data-node="高汤粉" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(高汤粉)$}&sid=&remark={$GetRequest(remark)$}"><span></span>高汤粉</a></li>
<li><a data-node="高汤面" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(高汤面)$}&sid=&remark={$GetRequest(remark)$}"><span></span>高汤面</a></li>
<li><a data-node="米饭" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(米饭)$}&sid=&remark={$GetRequest(remark)$}"><span></span>米饭</a></li>
<li><a data-node="水饺" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(水饺)$}&sid=&remark={$GetRequest(remark)$}"><span></span>水饺</a></li>
<li><a data-node="小吃" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(小吃)$}&sid=&remark={$GetRequest(remark)$}"><span></span>小吃</a></li>
<li><a data-node="私厨水饺" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(私厨水饺)$}&sid=&remark={$GetRequest(remark)$}"><span></span>私厨水饺</a></li>
<li><a data-node="饮料/汤" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(饮料/汤)$}&sid=&remark={$GetRequest(remark)$}"><span></span>饮料/汤</a></li>
<li><a data-node="饮料/汤" href="{ZL:GetLastinfo(1)/}?n={$GetUrlencode(饮料/汤)$}&sid=&remark={$GetRequest(remark)$}"><span></span>饮料/汤</a></li>
<div class="clearfix"></div>
</ul>
</div>
<div class="mobile_banner">
<div class="slider">
<ul>
<li><a href="#"><img src="{$CssDir/}images/fan3.jpg" alt="" /><span></span></a></li>
<li><a href="#"><img src="{$CssDir/}images/fan3.jpg" alt="" /><span></span></a></li>
<li><a href="#"><img src="{$CssDir/}images/fan3.jpg" alt="" /><span></span></a></li>
</ul>
</div>
</div>

<div class="mobile_food">
<div class="mobile_food_t">热卖商品</div>
<div class="mobile_food_b"><i class="fa fa-spinner fa-spin"></i></div>
</div>

{ZL.Label id="微信底部"/}
{ZL.Label id="微信弹出菜单"/}

<div class="closed_div" style="display:none;">
<p>已经打佯，请于每天8点-20点来点餐，我们会员商城更精彩哦!</p>
<a href="#" class="btn btn-danger">点击进入</a>
</div>

<div class="modal-backdrop fade in" style="display:none;" id="closed_body"></div>
<div class="weui_dialog_alert" id="dialog2" style="display:none">
<div class="weui_mask"></div>
<div class="weui_dialog">
<div class="weui_dialog_hd"><strong class="weui_dialog_title">友情提示</strong></div>
<div class="weui_dialog_bd">您当前会员级别为:微信会员，升级为官方正式会员，能享受积分和更多优惠哦^_^</div>
<div class="weui_dialog_ft">
<a href="/User/VIPUpgrade.aspx" class="weui_btn_dialog primary">立即升级</a>
<a href="javascript:$('#closed_body').hide();$('#dialog2').hide();" class="weui_btn_dialog default">我知道了</a>
</div>
</div>
</div>


</body>
</html>
<script>
(function($){
    $.fn.yxMobileSlider = function(settings){
        var defaultSettings = {
            width: '100%', //容器宽度
            height: 'auto', //容器高度
            during: 5000, //间隔时间
            speed:30 //滑动速度
        }
        settings = $.extend(true, {}, defaultSettings, settings);
        return this.each(function(){
            var _this = $(this), s = settings;
            var startX = 0, startY = 0; //触摸开始时手势横纵坐标 
            var temPos; //滚动元素当前位置
            var iCurr = 0; //当前滚动屏幕数
            var timer = null; //计时器
            var oMover = $("ul", _this); //滚动元素
            var oLi = $("li", oMover); //滚动单元
            var num = oLi.length; //滚动屏幕数
            var oPosition = {}; //触点位置
            var moveWidth = s.width; //滚动宽度
            //初始化主体样式
            _this.width(s.width).height(s.height).css({
                position: 'relative',
                overflow: 'hidden',
				margin:'0 auto'
            }); //设定容器宽高及样式
            oMover.css({
                position: 'absolute',
                left: 0
            });
            oLi.css({
                float: 'left',
                display: 'inline'
            });
            $("img", oLi).css({
                width: '100%',
                height: 'auto'
            });
            //初始化焦点容器及按钮
            _this.append('<div class="focus"><div></div></div>');
            var oFocusContainer = $(".focus");
            for (var i = 0; i < num; i++) {
                $("div", oFocusContainer).append("<span></span>");
            }
            var oFocus = $("span", oFocusContainer);
            oFocusContainer.css({
                minHeight: $(this).find('span').height() * 2,
                position: 'absolute',
                bottom: 0,
                background: 'rgba(0,0,0,0.5)'
            })
            $("span", oFocusContainer).css({
                display: 'block',
                float: 'left',
                cursor: 'pointer'
            })
            $("div", oFocusContainer).width(oFocus.outerWidth(true) * num).css({
                position: 'absolute',
                right: 10,
                top: '50%',
                marginTop: -$(this).find('span').width() / 2
            });
            oFocus.first().addClass("current");
            //页面加载或发生改变
            $(window).bind('resize load', function(){
                if (isMobile()) {
                    mobileSettings();
                    bindTochuEvent();
                }
                oLi.width(_this.width()).height(_this.height());//设定滚动单元宽高
                oMover.width(num * oLi.width());
                oFocusContainer.width(_this.width()).height(_this.height() * 0.15).css({
                    zIndex: 2
                });//设定焦点容器宽高样式
                _this.fadeIn(300);
            });
            //页面加载完毕BANNER自动滚动
            autoMove();
            //PC机下焦点切换
            if (!isMobile()) {
                oFocus.hover(function(){
                    iCurr = $(this).index() - 1;
                    stopMove();
                    doMove();
                }, function(){
                    autoMove();
                })
            }
            //自动运动
            function autoMove(){
                timer = setInterval(doMove, s.during);
            }
            //停止自动运动
            function stopMove(){
                clearInterval(timer);
            }
            //运动效果
            function doMove(){
                iCurr = iCurr >= num - 1 ? 0 : iCurr + 1;
                doAnimate(-moveWidth * iCurr);
                oFocus.eq(iCurr).addClass("current").siblings().removeClass("current");
            }
            //绑定触摸事件
            function bindTochuEvent(){
                oMover.get(0).addEventListener('touchstart', touchStartFunc, false);
                oMover.get(0).addEventListener('touchmove', touchMoveFunc, false);
                oMover.get(0).addEventListener('touchend', touchEndFunc, false);
            }
            //获取触点位置
            function touchPos(e){
                var touches = e.changedTouches, l = touches.length, touch, tagX, tagY;
                for (var i = 0; i < l; i++) {
                    touch = touches[i];
                    tagX = touch.clientX;
                    tagY = touch.clientY;
                }
                oPosition.x = tagX;
                oPosition.y = tagY;
                return oPosition;
            }
            //触摸开始
            function touchStartFunc(e){
                clearInterval(timer);
                touchPos(e);
                startX = oPosition.x;
                startY = oPosition.y;
                temPos = oMover.position().left;
            }
            //触摸移动 
            function touchMoveFunc(e){
                touchPos(e);
                var moveX = oPosition.x - startX;
                var moveY = oPosition.y - startY;
                if (Math.abs(moveY) < Math.abs(moveX)) {
                    e.preventDefault();
                    oMover.css({
                        left: temPos + moveX
                    });
                }
            }
            //触摸结束
            function touchEndFunc(e){
                touchPos(e);
                var moveX = oPosition.x - startX;
                var moveY = oPosition.y - startY;
                if (Math.abs(moveY) < Math.abs(moveX)) {
                    if (moveX > 0) {
                        iCurr--;
                        if (iCurr >= 0) {
                            var moveX = iCurr * moveWidth;
                            doAnimate(-moveX, autoMove);
                        }
                        else {
                            doAnimate(0, autoMove);
                            iCurr = 0;
                        }
                    }
                    else {
                        iCurr++;
                        if (iCurr < num && iCurr >= 0) {
                            var moveX = iCurr * moveWidth;
                            doAnimate(-moveX, autoMove);
                        }
                        else {
                            iCurr = num - 1;
                            doAnimate(-(num - 1) * moveWidth, autoMove);
                        }
                    }
                    oFocus.eq(iCurr).addClass("current").siblings().removeClass("current");
                }
            }
            //移动设备基于屏幕宽度设置容器宽高
            function mobileSettings(){
                moveWidth = $(window).width();
                var iScale = $(window).width() / s.width;
                _this.height(s.height * iScale).width($(window).width());
                oMover.css({
                    left: -iCurr * moveWidth
                });
            }
            //动画效果
            function doAnimate(iTarget, fn){
                oMover.stop().animate({
                    left: iTarget
                }, _this.speed , function(){
                    if (fn) 
                        fn();
                });
            }
            //判断是否是移动设备
            function isMobile(){
                if (navigator.userAgent.match(/Android/i) || navigator.userAgent.indexOf('iPhone') != -1 || navigator.userAgent.indexOf('iPod') != -1 || navigator.userAgent.indexOf('iPad') != -1) {
                    return true;
                }
                else {
                    return false;
                }
            }
        });
    }
})(jQuery);
$(".slider").yxMobileSlider({width:'100%',height:($(".container").width()*250/375),during:3000})
var cp=1;
var para = {
	key:'',
	alias:'shoplist',
	psize:'10',
	cpage:cp,
	proclass:'{$GetRequest(ProClass)$}'
}
$.post("/API/Center.ashx?action=GetCustom",para,function(data){
	data=JSON.parse(data);
	var str="";
	if(data.retcode=="1")
	{
		data=JSON.parse(data.result)
		console.log(data);
		for(i=0;i<data.length;i++)
		{
			str+="<div class=\"mobile_food_c\"><a href=\"/shop/"+data[i].id+".aspx?remark={$GetRequest(remark)$}\"><img src=\"/UploadFiles/"+data[i].thumbnails+"\" alt=\""+data.proname+"\" /></a><div class=\"mobile_food_cb\"><h3><a href=\"/shop/"+data[i].id+".aspx?remark={$GetRequest(remark)$}\">"+data[i].proname+"</a><span>"+data[i].storename+"</span></h3><p><span style=\"\">月售"+data[i].ys+"份</span><span><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i></span><span>￥"+data[i].linprice+"元/份</span></p></div></div>";	
		}
		$(".mobile_food_b").before(str);
	}
})
$(window).scroll(function(){
	if($(window).scrollTop() >= $(document).height() - $(window).height())
	{
		para.cpage++;
		$.post("/API/Center.ashx?action=GetCustom",para,function(data){
			data=JSON.parse(data);
			var str="";
			if(data.retcode=="1")
			{
				data=JSON.parse(data.result)
				if(data.length>0)
				{
					for(i=0;i<data.length;i++)
					{
						str+="<div class=\"mobile_food_c\"><a href=\"/shop/"+data[i].id+".aspx?remark={$GetRequest(remark)$}\"><img src=\"/UploadFiles/"+data[i].thumbnails+"\" alt=\""+data.proname+"\" /></a><div class=\"mobile_food_cb\"><h3><a href=\"/shop/"+data[i].id+".aspx?remark={$GetRequest(remark)$}\">"+data[i].proname+"</a><span>"+data[i].storename+"</span></h3><p><span style=\"\">月售"+data[i].ys+"份</span><span><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i><i class=\"fa fa-star\"></i></span><span>￥"+data[i].linprice+"元/份</span></p></div></div>";	
					}
					$(".mobile_food_b").before(str);
				}
				else
				{
					$(".mobile_food_b").html("暂无更多商品...")
				}
			}			
		});
	}
});
$().ready(function(e) {
	var closed='{ZL.Label id="打烊状态"/}';
	if(closed=="1")
	{
		$("#closed_body").show();
		$(".closed_div").show().css("margin-top","-"+($(".closed_div").height()/2)+"px");
		$("html").css("height","100%").css("overflow","hidden");
		$("body").css("height","100%").css("overflow","hidden");
	}
	else
	{
		$("#closed_body").remove();
		$(".closed_div").remove();
	}
	var buser = new B_User();
	buser.IsLogged(function(data,flag){
		if(flag)
		{
			data=JSON.parse(data);
			if(data.GroupID==1)
			{
				$("#closed_body").show();
				$("#dialog2").show();
			}
		}
		else
		{
			$("#closed_body").show();
			$("#dialog2").show();
		}
	});
});
$(function(){
	//menu float
	var menufloatclicknumber=0;
	function menufloatin(){
		$(".menu-c").removeClass("out");
		$("#menufloat").addClass("show")
		$(".mask_menu").fadeIn();
		$("#menufloat-c").show();
		$(".menu-c-inner").removeClass("outer");
		$(".menu-c-inner").addClass("in")
		$(".menu-c-inner a").show();
		menufloatclicknumber=1;
	}
	function menufloatout(){
		$("#menufloat").removeClass("show")
		$(".mask_menu").fadeOut();
		$(".menu-c-inner").removeClass("in")
		$(".menu-c-inner").addClass("outer")
		$(".menu-c-inner a").hide();
		$(".menu-c").addClass("out");
		menufloatclicknumber=0;		
	}	   
	$("#menufloat").click(function(){
		if(menufloatclicknumber==0){ menufloatin(); }
		else { menufloatout();}			 	
	})
	$(".mask_menu").click(function(){
		menufloatout(); 
	})
});
</script>